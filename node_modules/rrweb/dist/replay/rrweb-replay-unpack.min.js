var rrwebReplay=function(ge){"use strict";var C;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(C||(C={}));function jt(e){return e.nodeType===e.ELEMENT_NODE}class We{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const i=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return i??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const i=n.id;this.idNodeMap.set(i,t),this.nodeMetaMap.set(t,n)}replace(t,n){const i=this.getNode(t);if(i){const r=this.nodeMetaMap.get(i);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Gt(){return new We}function Yt(e){return e.toLowerCase()}function Ht(e,t){return!e||!t||e.type!==t.type?!1:e.type===C.Document?e.compatMode===t.compatMode:e.type===C.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===C.Comment||e.type===C.Text||e.type===C.CDATA?e.textContent===t.textContent:e.type===C.Element?e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock:!1}const je=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function zt(e,t={}){let n=1,i=1;function r(f){const p=f.match(/\n/g);p&&(n+=p.length);const w=f.lastIndexOf(`
`);i=w===-1?i+f.length:f.length-w}function a(){const f={line:n,column:i};return p=>(p.position=new s(f),y(),p)}class s{constructor(p){this.start=p,this.end={line:n,column:i},this.source=t.source}}s.prototype.content=e;const o=[];function l(f){const p=new Error(`${t.source||""}:${n}:${i}: ${f}`);if(p.reason=f,p.filename=t.source,p.line=n,p.column=i,p.source=e,t.silent)o.push(p);else throw p}function c(){const f=h();return{type:"stylesheet",stylesheet:{source:t.source,rules:f,parsingErrors:o}}}function u(){return g(/^{\s*/)}function d(){return g(/^}/)}function h(){let f;const p=[];for(y(),N(p);e.length&&e.charAt(0)!=="}"&&(f=ee()||ae());)f&&(p.push(f),N(p));return p}function g(f){const p=f.exec(e);if(!p)return;const w=p[0];return r(w),e=e.slice(w.length),p}function y(){g(/^\s*/)}function N(f=[]){let p;for(;p=T();)p&&f.push(p),p=T();return f}function T(){const f=a();if(e.charAt(0)!=="/"||e.charAt(1)!=="*")return;let p=2;for(;e.charAt(p)!==""&&(e.charAt(p)!=="*"||e.charAt(p+1)!=="/");)++p;if(p+=2,e.charAt(p-1)==="")return l("End of comment missing");const w=e.slice(2,p-2);return i+=2,r(w),e=e.slice(p),i+=2,f({type:"comment",comment:w})}function m(){for(y();e[0]=="}";)l("extra closing bracket"),e=e.slice(1),y();const f=g(/^(((?<!\\)"(?:\\"|[^"])*"|(?<!\\)'(?:\\'|[^'])*'|[^{])+)/);if(!f)return;const p=f[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,w=>w.replace(/,/g,"\u200C"));return E(p).map(w=>w.replace(/\u200C/g,",").trim())}function E(f){const p=[];let w="",A=0,P=0,W=null;for(const j of f){const Se=w.endsWith("\\");W?W===j&&!Se&&(W=null):j==="("?A++:j===")"?A--:j==="["?P++:j==="]"?P--:`'"`.includes(j)&&(W=j),j===","&&A===0&&P===0?(p.push(w),w=""):w+=j}return w&&p.push(w),p}function v(){const f=a(),p=g(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!p)return;const w=z(p[0]);if(!g(/^:\s*/))return l("property missing ':'");const A=g(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),P=f({type:"declaration",property:w.replace(je,""),value:A?z(A[0]).replace(je,""):""});return g(/^[;\s]*/),P}function b(){const f=[];if(!u())return l("missing '{'");N(f);let p;for(;p=v();)p!==!1&&(f.push(p),N(f)),p=v();return d()?f:l("missing '}'")}function x(){let f;const p=[],w=a();for(;f=g(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)p.push(f[1]),g(/^,\s*/);if(p.length)return w({type:"keyframe",values:p,declarations:b()})}function L(){const f=a();let p=g(/^@([-\w]+)?keyframes\s*/);if(!p)return;const w=p[1];if(p=g(/^([-\w]+)\s*/),!p)return l("@keyframes missing name");const A=p[1];if(!u())return l("@keyframes missing '{'");let P,W=N();for(;P=x();)W.push(P),W=W.concat(N());return d()?f({type:"keyframes",name:A,vendor:w,keyframes:W}):l("@keyframes missing '}'")}function V(){const f=a(),p=g(/^@supports *([^{]+)/);if(!p)return;const w=z(p[1]);if(!u())return l("@supports missing '{'");const A=N().concat(h());return d()?f({type:"supports",supports:w,rules:A}):l("@supports missing '}'")}function F(){const f=a();if(!g(/^@host\s*/))return;if(!u())return l("@host missing '{'");const p=N().concat(h());return d()?f({type:"host",rules:p}):l("@host missing '}'")}function K(){const f=a(),p=g(/^@media *([^{]+)/);if(!p)return;const w=z(p[1]);if(!u())return l("@media missing '{'");const A=N().concat(h());return d()?f({type:"media",media:w,rules:A}):l("@media missing '}'")}function pe(){const f=a(),p=g(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(p)return f({type:"custom-media",name:z(p[1]),media:z(p[2])})}function fe(){const f=a();if(!g(/^@page */))return;const p=m()||[];if(!u())return l("@page missing '{'");let w=N(),A;for(;A=v();)w.push(A),w=w.concat(N());return d()?f({type:"page",selectors:p,declarations:w}):l("@page missing '}'")}function J(){const f=a(),p=g(/^@([-\w]+)?document *([^{]+)/);if(!p)return;const w=z(p[1]),A=z(p[2]);if(!u())return l("@document missing '{'");const P=N().concat(h());return d()?f({type:"document",document:A,vendor:w,rules:P}):l("@document missing '}'")}function Y(){const f=a();if(!g(/^@font-face\s*/))return;if(!u())return l("@font-face missing '{'");let p=N(),w;for(;w=v();)p.push(w),p=p.concat(N());return d()?f({type:"font-face",declarations:p}):l("@font-face missing '}'")}const Z=k("import"),se=k("charset"),$=k("namespace");function k(f){const p=new RegExp("^@"+f+"\\s*((?:"+['(?<!\\\\)"(?:\\\\"|[^"])*"',"(?<!\\\\)'(?:\\\\'|[^'])*'","[^;]"].join("|")+")+);");return()=>{const w=a(),A=g(p);if(!A)return;const P={type:f};return P[f]=A[1].trim(),w(P)}}function ee(){if(e[0]==="@")return L()||K()||pe()||V()||Z()||se()||$()||J()||fe()||F()||Y()}function ae(){const f=a(),p=m();return p?(N(),f({type:"rule",selectors:p,declarations:b()})):l("selector missing")}return Me(c())}function z(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Me(e,t){const n=e&&typeof e.type=="string",i=n?e:t;for(const r of Object.keys(e)){const a=e[r];Array.isArray(a)?a.forEach(s=>{Me(s,i)}):a&&typeof a=="object"&&Me(a,i)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}const Ge={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Xt(e){let t=Ge[e.tagName]?Ge[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function Ye(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const He=/(max|min)-device-(width|height)/,Qt=new RegExp(He.source,"g"),ze=/([^\\]):hover/,qt=new RegExp(ze.source,"g");function Xe(e,t){const n=t?.stylesWithHoverClass.get(e);if(n)return n;const i=zt(e,{silent:!0});if(!i.stylesheet)return e;const r=[],a=[];function s(l){"selectors"in l&&l.selectors&&l.selectors.forEach(c=>{ze.test(c)&&r.push(c)}),"media"in l&&l.media&&He.test(l.media)&&a.push(l.media),"rules"in l&&l.rules&&l.rules.forEach(s)}s(i.stylesheet);let o=e;if(r.length>0){const l=new RegExp(r.filter((c,u)=>r.indexOf(c)===u).sort((c,u)=>u.length-c.length).map(c=>Ye(c)).join("|"),"g");o=o.replace(l,c=>{const u=c.replace(qt,"$1.\\:hover");return`${c}, ${u}`})}if(a.length>0){const l=new RegExp(a.filter((c,u)=>a.indexOf(c)===u).sort((c,u)=>u.length-c.length).map(c=>Ye(c)).join("|"),"g");o=o.replace(l,c=>c.replace(Qt,"$1-$2"))}return t?.stylesWithHoverClass.set(e,o),o}function Qe(){return{stylesWithHoverClass:new Map}}function Jt(e,t){var n;const{doc:i,hackCss:r,cache:a}=t;switch(e.type){case C.Document:return i.implementation.createDocument(null,"",null);case C.DocumentType:return i.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case C.Element:{const s=Xt(e);let o;e.isSVG?o=i.createElementNS("http://www.w3.org/2000/svg",s):(e.isCustom&&((n=i.defaultView)===null||n===void 0?void 0:n.customElements)&&!i.defaultView.customElements.get(e.tagName)&&i.defaultView.customElements.define(e.tagName,class extends i.defaultView.HTMLElement{}),o=i.createElement(s));const l={};for(const c in e.attributes){if(!Object.prototype.hasOwnProperty.call(e.attributes,c))continue;let u=e.attributes[c];if(s==="option"&&c==="selected"&&u===!1||u===null)continue;if(u===!0&&(u=""),c.startsWith("rr_")){l[c]=u;continue}const d=s==="textarea"&&c==="value",h=s==="style"&&c==="_cssText";if(h&&r&&typeof u=="string"&&(u=Xe(u,a)),(d||h)&&typeof u=="string"){o.appendChild(i.createTextNode(u)),e.childNodes=[];continue}try{if(e.isSVG&&c==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",c,u.toString());else if(c==="onload"||c==="onclick"||c.substring(0,7)==="onmouse")o.setAttribute("_"+c,u.toString());else if(s==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&c==="content"){o.setAttribute("csp-content",u.toString());continue}else s==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||s==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(s==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",e.attributes.srcset):o.setAttribute(c,u.toString()))}catch{}}for(const c in l){const u=l[c];if(s==="canvas"&&c==="rr_dataURL"){const d=document.createElement("img");d.onload=()=>{const h=o.getContext("2d");h&&h.drawImage(d,0,0,d.width,d.height)},d.src=u.toString(),o.RRNodeType&&(o.rr_dataURL=u.toString())}else if(s==="img"&&c==="rr_dataURL"){const d=o;d.currentSrc.startsWith("data:")||(d.setAttribute("rrweb-original-src",e.attributes.src),d.src=u.toString())}if(c==="rr_width")o.style.width=u.toString();else if(c==="rr_height")o.style.height=u.toString();else if(c==="rr_mediaCurrentTime"&&typeof u=="number")o.currentTime=u;else if(c==="rr_mediaState")switch(u){case"played":o.play().catch(d=>console.warn("media playback error",d));break;case"paused":o.pause();break}else c==="rr_mediaPlaybackRate"&&typeof u=="number"?o.playbackRate=u:c==="rr_mediaMuted"&&typeof u=="boolean"?o.muted=u:c==="rr_mediaLoop"&&typeof u=="boolean"?o.loop=u:c==="rr_mediaVolume"&&typeof u=="number"&&(o.volume=u)}if(e.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case C.Text:return i.createTextNode(e.isStyle&&r?Xe(e.textContent,a):e.textContent);case C.CDATA:return i.createCDATASection(e.textContent);case C.Comment:return i.createComment(e.textContent);default:return null}}function le(e,t){const{doc:n,mirror:i,skipChild:r=!1,hackCss:a=!0,afterAppend:s,cache:o}=t;if(i.has(e.id)){const c=i.getNode(e.id),u=i.getMeta(c);if(Ht(u,e))return i.getNode(e.id)}let l=Jt(e,{doc:n,hackCss:a,cache:o});if(!l)return null;if(e.rootId&&i.getNode(e.rootId)!==n&&i.replace(e.rootId,n),e.type===C.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==C.DocumentType&&(e.childNodes[0].type===C.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),l=n),i.add(l,e),(e.type===C.Document||e.type===C.Element)&&!r)for(const c of e.childNodes){const u=le(c,{doc:n,mirror:i,skipChild:!1,hackCss:a,afterAppend:s,cache:o});if(!u){console.warn("Failed to rebuild",c);continue}if(c.isShadow&&jt(l)&&l.shadowRoot)l.shadowRoot.appendChild(u);else if(e.type===C.Document&&c.type==C.Element){const d=u;let h=null;d.childNodes.forEach(g=>{g.nodeName==="BODY"&&(h=g)}),h?(d.removeChild(h),l.appendChild(u),d.appendChild(h)):l.appendChild(u)}else l.appendChild(u);s&&s(u,c.id)}return l}function Zt(e,t){function n(i){t(i)}for(const i of e.getIds())e.has(i)&&n(e.getNode(i))}function Kt(e,t){const n=t.getMeta(e);if(n?.type!==C.Element)return;const i=e;for(const r in n.attributes){if(!(Object.prototype.hasOwnProperty.call(n.attributes,r)&&r.startsWith("rr_")))continue;const a=n.attributes[r];r==="rr_scrollLeft"&&(i.scrollLeft=a),r==="rr_scrollTop"&&(i.scrollTop=a)}}function en(e,t){const{doc:n,onVisit:i,hackCss:r=!0,afterAppend:a,cache:s,mirror:o=new We}=t,l=le(e,{doc:n,mirror:o,skipChild:!1,hackCss:r,afterAppend:a,cache:s});return Zt(o,c=>{i&&i(c),Kt(c,o)}),l}var S;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(S||(S={}));class tn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const i=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return i??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const i=n.id;this.idNodeMap.set(i,t),this.nodeMetaMap.set(t,n)}replace(t,n){const i=this.getNode(t);if(i){const r=this.nodeMetaMap.get(i);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function nn(){return new tn}function rn(e){const t={},n=/;(?![^(]*\))/g,i=/:(.+)/,r=/\/\*.*?\*\//g;return e.replace(r,"").split(n).forEach(function(a){if(a){const s=a.split(i);s.length>1&&(t[De(s[0].trim())]=s[1].trim())}}),t}function qe(e){const t=[];for(const n in e){const i=e[n];if(typeof i!="string")continue;const r=ln(n);t.push(`${r}: ${i};`)}return t.join(" ")}const on=/-([a-z])/g,sn=/^--[a-zA-Z0-9-]+$/,De=e=>sn.test(e)?e:e.replace(on,(t,n)=>n?n.toUpperCase():""),an=/\B([A-Z])/g,ln=e=>e.replace(an,"-$1").toLowerCase();class U{constructor(...t){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=O.ELEMENT_NODE,this.TEXT_NODE=O.TEXT_NODE}get childNodes(){const t=[];let n=this.firstChild;for(;n;)t.push(n),n=n.nextSibling;return t}contains(t){if(t instanceof U){if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0}else return!1;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function cn(e){return class Wt extends e{constructor(...n){super(n),this.nodeType=O.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=S.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===S.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(i=>i.RRNodeType===S.Element&&i.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(i=>i.RRNodeType===S.Element&&i.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const i=n.RRNodeType;if((i===S.Element||i===S.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${i===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const r=Ce(this,n);return r.parentElement=null,r}insertBefore(n,i){const r=n.RRNodeType;if((r===S.Element||r===S.DocumentType)&&this.childNodes.some(s=>s.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${r===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const a=nt(this,n,i);return a.parentElement=null,a}removeChild(n){return it(this,n)}open(){this.firstChild=null,this.lastChild=null}close(){}write(n){let i;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?i="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(i="-//W3C//DTD HTML 4.0 Transitional//EN"),i){const r=this.createDocumentType("html",i,"");this.open(),this.appendChild(r)}}createDocument(n,i,r){return new Wt}createDocumentType(n,i,r){const a=new(Je(U))(n,i,r);return a.ownerDocument=this,a}createElement(n){const i=new(Ze(U))(n);return i.ownerDocument=this,i}createElementNS(n,i){return this.createElement(i)}createTextNode(n){const i=new(Ke(U))(n);return i.ownerDocument=this,i}createComment(n){const i=new(et(U))(n);return i.ownerDocument=this,i}createCDATASection(n){const i=new(tt(U))(n);return i.ownerDocument=this,i}toString(){return"RRDocument"}}}function Je(e){return class extends e{constructor(t,n,i){super(),this.nodeType=O.DOCUMENT_TYPE_NODE,this.RRNodeType=S.DocumentType,this.name=t,this.publicId=n,this.systemId=i,this.nodeName=t,this.textContent=null}toString(){return"RRDocumentType"}}}function Ze(e){return class extends e{constructor(t){super(),this.nodeType=O.ELEMENT_NODE,this.RRNodeType=S.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(t))}get classList(){return new dn(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?rn(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(i,r,a)=>{if(n.test(i))return;const s=De(i);r?t[s]=r:delete t[s],a==="important"&&(t[s]+=" !important"),this.attributes.style=qe(t)},t.removeProperty=i=>{if(n.test(i))return"";const r=De(i),a=t[r]||"";return delete t[r],this.attributes.style=qe(t),a},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,i){this.setAttribute(n,i)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return Ce(this,t)}insertBefore(t,n){return nt(this,t,n)}removeChild(t){return it(this,t)}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function un(e){return class extends e{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Ke(e){return class extends e{constructor(t){super(),this.nodeType=O.TEXT_NODE,this.nodeName="#text",this.RRNodeType=S.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function et(e){return class extends e{constructor(t){super(),this.nodeType=O.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=S.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function tt(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=O.CDATA_SECTION_NODE,this.RRNodeType=S.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class dn{constructor(t,n){if(this.classes=[],this.add=(...i)=>{for(const r of i){const a=String(r);this.classes.indexOf(a)>=0||this.classes.push(a)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...i)=>{this.classes=this.classes.filter(r=>i.indexOf(r)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const i=t.trim().split(/\s+/);this.classes.push(...i)}this.onChange=n}}function Ce(e,t){return t.parentNode&&t.parentNode.removeChild(t),e.lastChild?(e.lastChild.nextSibling=t,t.previousSibling=e.lastChild):(e.firstChild=t,t.previousSibling=null),e.lastChild=t,t.nextSibling=null,t.parentNode=e,t.parentElement=e,t.ownerDocument=e.ownerDocument,t}function nt(e,t,n){if(!n)return Ce(e,t);if(n.parentNode!==e)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return t===n||(t.parentNode&&t.parentNode.removeChild(t),t.previousSibling=n.previousSibling,n.previousSibling=t,t.nextSibling=n,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,t.parentElement=e,t.parentNode=e,t.ownerDocument=e.ownerDocument),t}function it(e,t){if(t.parentNode!==e)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return t.previousSibling?t.previousSibling.nextSibling=t.nextSibling:e.firstChild=t.nextSibling,t.nextSibling?t.nextSibling.previousSibling=t.previousSibling:e.lastChild=t.previousSibling,t.previousSibling=null,t.nextSibling=null,t.parentElement=null,t.parentNode=null,t}var O;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(O||(O={}));const Re={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},hn={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let H=null;function ye(e,t,n,i=t.mirror||t.ownerDocument.mirror){e=mn(e,t,n,i),rt(e,t,n,i),pn(e,t,n)}function mn(e,t,n,i){var r;if(n.afterAppend&&!H&&(H=new WeakSet,setTimeout(()=>{H=null},0)),!xe(e,t)){const a=ve(t,n.mirror,i);(r=e.parentNode)===null||r===void 0||r.replaceChild(a,e),e=a}switch(t.RRNodeType){case S.Document:{if(!te(e,t,n.mirror,i)){const a=i.getMeta(t);a&&(n.mirror.removeNodeFromMap(e),e.close(),e.open(),n.mirror.add(e,a),H?.add(e))}break}case S.Element:{const a=e,s=t;switch(s.tagName){case"IFRAME":{const o=e.contentDocument;if(!o)break;ye(o,t.contentDocument,n,i);break}}s.shadowRoot&&(a.shadowRoot||a.attachShadow({mode:"open"}),rt(a.shadowRoot,s.shadowRoot,n,i)),fn(a,s,i);break}}return e}function pn(e,t,n){var i;switch(t.RRNodeType){case S.Document:{const r=t.scrollData;r&&n.applyScroll(r,!0);break}case S.Element:{const r=e,a=t;switch(a.scrollData&&n.applyScroll(a.scrollData,!0),a.inputData&&n.applyInput(a.inputData),a.tagName){case"AUDIO":case"VIDEO":{const s=e,o=a;o.paused!==void 0&&(o.paused?s.pause():s.play()),o.muted!==void 0&&(s.muted=o.muted),o.volume!==void 0&&(s.volume=o.volume),o.currentTime!==void 0&&(s.currentTime=o.currentTime),o.playbackRate!==void 0&&(s.playbackRate=o.playbackRate),o.loop!==void 0&&(s.loop=o.loop);break}case"CANVAS":{const s=t;if(s.rr_dataURL!==null){const o=document.createElement("img");o.onload=()=>{const l=r.getContext("2d");l&&l.drawImage(o,0,0,o.width,o.height)},o.src=s.rr_dataURL}s.canvasMutations.forEach(o=>n.applyCanvas(o.event,o.mutation,e));break}case"STYLE":{const s=r.sheet;s&&t.rules.forEach(o=>n.applyStyleSheetMutation(o,s));break}}break}case S.Text:case S.Comment:case S.CDATA:{e.textContent!==t.data&&(e.textContent=t.data);break}}H!=null&&H.has(e)&&(H.delete(e),(i=n.afterAppend)===null||i===void 0||i.call(n,e,n.mirror.getId(e)))}function fn(e,t,n){const i=e.attributes,r=t.attributes;for(const a in r){const s=r[a],o=n.getMeta(t);if(o?.isSVG&&Re[a])e.setAttributeNS(Re[a],a,s);else if(t.tagName==="CANVAS"&&a==="rr_dataURL"){const l=document.createElement("img");l.src=s,l.onload=()=>{const c=e.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)}}else{if(t.tagName==="IFRAME"&&a==="srcdoc")continue;e.setAttribute(a,s)}}for(const{name:a}of Array.from(i))a in r||e.removeAttribute(a);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function rt(e,t,n,i){const r=Array.from(e.childNodes),a=t.childNodes;if(r.length===0&&a.length===0)return;let s=0,o=r.length-1,l=0,c=a.length-1,u=r[s],d=r[o],h=a[l],g=a[c],y,N;for(;s<=o&&l<=c;)if(u===void 0)u=r[++s];else if(d===void 0)d=r[--o];else if(te(u,h,n.mirror,i))u=r[++s],h=a[++l];else if(te(d,g,n.mirror,i))d=r[--o],g=a[--c];else if(te(u,g,n.mirror,i)){try{e.insertBefore(u,d.nextSibling)}catch(E){console.warn(E)}u=r[++s],g=a[--c]}else if(te(d,h,n.mirror,i)){try{e.insertBefore(d,u)}catch(E){console.warn(E)}d=r[--o],h=a[++l]}else{if(!y){y={};for(let v=s;v<=o;v++){const b=r[v];b&&n.mirror.hasNode(b)&&(y[n.mirror.getId(b)]=v)}}N=y[i.getId(h)];const E=r[N];if(N!==void 0&&E&&te(E,h,n.mirror,i)){try{e.insertBefore(E,u)}catch(v){console.warn(v)}r[N]=void 0}else{const v=ve(h,n.mirror,i);e.nodeName==="#document"&&u&&(v.nodeType===v.DOCUMENT_TYPE_NODE&&u.nodeType===u.DOCUMENT_TYPE_NODE||v.nodeType===v.ELEMENT_NODE&&u.nodeType===u.ELEMENT_NODE)&&(e.removeChild(u),n.mirror.removeNodeFromMap(u),u=r[++s]);try{e.insertBefore(v,u||null)}catch(b){console.warn(b)}}h=a[++l]}if(s>o){const E=a[c+1];let v=null;for(E&&(v=n.mirror.getNode(i.getId(E)));l<=c;++l){const b=ve(a[l],n.mirror,i);try{e.insertBefore(b,v)}catch(x){console.warn(x)}}}else if(l>c)for(;s<=o;s++){const E=r[s];if(!(!E||E.parentNode!==e))try{e.removeChild(E),n.mirror.removeNodeFromMap(E)}catch(v){console.warn(v)}}let T=e.firstChild,m=t.firstChild;for(;T!==null&&m!==null;)ye(T,m,n,i),T=T.nextSibling,m=m.nextSibling}function ve(e,t,n){const i=n.getId(e),r=n.getMeta(e);let a=null;if(i>-1&&(a=t.getNode(i)),a!==null&&xe(a,e))return a;switch(e.RRNodeType){case S.Document:a=new Document;break;case S.DocumentType:a=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case S.Element:{let s=e.tagName.toLowerCase();s=hn[s]||s,r&&"isSVG"in r&&r?.isSVG?a=document.createElementNS(Re.svg,s):a=document.createElement(e.tagName);break}case S.Text:a=document.createTextNode(e.data);break;case S.Comment:a=document.createComment(e.data);break;case S.CDATA:a=document.createCDATASection(e.data);break}r&&t.add(a,Object.assign({},r));try{H?.add(a)}catch{}return a}function xe(e,t){return e.nodeType!==t.nodeType?!1:e.nodeType!==e.ELEMENT_NODE||e.tagName.toUpperCase()===t.tagName}function te(e,t,n,i){const r=n.getId(e),a=i.getId(t);return r===-1||r!==a?!1:xe(e,t)}class ne extends cn(U){get unserializedId(){return this._unserializedId--}constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Dn(),this.scrollData=null,t&&(this.mirror=t)}createDocument(t,n,i){return new ne}createDocumentType(t,n,i){const r=new gn(t,n,i);return r.ownerDocument=this,r}createElement(t){const n=t.toUpperCase();let i;switch(n){case"AUDIO":case"VIDEO":i=new yn(n);break;case"IFRAME":i=new Nn(n,this.mirror);break;case"CANVAS":i=new vn(n);break;case"STYLE":i=new En(n);break;default:i=new ce(n);break}return i.ownerDocument=this,i}createComment(t){const n=new wn(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new bn(t);return n.ownerDocument=this,n}createTextNode(t){const n=new Tn(t);return n.ownerDocument=this,n}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const gn=Je(U);class ce extends Ze(U){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class yn extends un(ce){}class vn extends ce{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class En extends ce{constructor(){super(...arguments),this.rules=[]}}class Nn extends ce{constructor(t,n){super(t),this.contentDocument=new ne,this.contentDocument.mirror=n}}const Tn=Ke(U),wn=et(U),bn=tt(U);function Sn(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function ot(e,t,n,i){let r;switch(e.nodeType){case O.DOCUMENT_NODE:i&&i.nodeName==="IFRAME"?r=i.contentDocument:(r=t,r.compatMode=e.compatMode);break;case O.DOCUMENT_TYPE_NODE:{const s=e;r=t.createDocumentType(s.name,s.publicId,s.systemId);break}case O.ELEMENT_NODE:{const s=e,o=Sn(s);r=t.createElement(o);const l=r;for(const{name:c,value:u}of Array.from(s.attributes))l.attributes[c]=u;s.scrollLeft&&(l.scrollLeft=s.scrollLeft),s.scrollTop&&(l.scrollTop=s.scrollTop);break}case O.TEXT_NODE:r=t.createTextNode(e.textContent||"");break;case O.CDATA_SECTION_NODE:r=t.createCDATASection(e.data);break;case O.COMMENT_NODE:r=t.createComment(e.textContent||"");break;case O.DOCUMENT_FRAGMENT_NODE:r=i.attachShadow({mode:"open"});break;default:return null}let a=n.getMeta(e);return t instanceof ne&&(a||(a=st(r,t.unserializedId),n.add(e,a)),t.mirror.add(r,Object.assign({},a))),r}function Mn(e,t=nn(),n=new ne){function i(r,a){const s=ot(r,n,t,a);if(s!==null)if(a?.nodeName!=="IFRAME"&&r.nodeType!==O.DOCUMENT_FRAGMENT_NODE&&(a?.appendChild(s),s.parentNode=a,s.parentElement=a),r.nodeName==="IFRAME"){const o=r.contentDocument;o&&i(o,s)}else(r.nodeType===O.DOCUMENT_NODE||r.nodeType===O.ELEMENT_NODE||r.nodeType===O.DOCUMENT_FRAGMENT_NODE)&&(r.nodeType===O.ELEMENT_NODE&&r.shadowRoot&&i(r.shadowRoot,s),r.childNodes.forEach(o=>i(o,s)))}return i(e,null),n}function Dn(){return new Cn}class Cn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const i=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return i??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const i=n.id;this.idNodeMap.set(i,t),this.nodeMetaMap.set(t,n)}replace(t,n){const i=this.getNode(t);if(i){const r=this.nodeMetaMap.get(i);r&&this.nodeMetaMap.set(n,r)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function st(e,t){switch(e.RRNodeType){case S.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case S.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case S.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case S.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function at(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map(function(r){r(n)}),(i=e.get("*"))&&i.slice().map(function(r){r(t,n)})}}}var Rn=Object.freeze({__proto__:null,default:at});function xn(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,i=468,r={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||l,scrollIntoView:n.prototype.scrollIntoView},a=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function s(m){const E=["MSIE ","Trident/","Edge/"];return new RegExp(E.join("|")).test(m)}const o=s(e.navigator.userAgent)?1:0;function l(m,E){this.scrollLeft=m,this.scrollTop=E}function c(m){return .5*(1-Math.cos(Math.PI*m))}function u(m){if(m===null||typeof m!="object"||m.behavior===void 0||m.behavior==="auto"||m.behavior==="instant")return!0;if(typeof m=="object"&&m.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+m.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(m,E){if(E==="Y")return m.clientHeight+o<m.scrollHeight;if(E==="X")return m.clientWidth+o<m.scrollWidth}function h(m,E){const v=e.getComputedStyle(m,null)["overflow"+E];return v==="auto"||v==="scroll"}function g(m){const E=d(m,"Y")&&h(m,"Y"),v=d(m,"X")&&h(m,"X");return E||v}function y(m){for(;m!==t.body&&g(m)===!1;)m=m.parentNode||m.host;return m}function N(m){const E=a();let v,b,x,L=(E-m.startTime)/i;L=L>1?1:L,v=c(L),b=m.startX+(m.x-m.startX)*v,x=m.startY+(m.y-m.startY)*v,m.method.call(m.scrollable,b,x),(b!==m.x||x!==m.y)&&e.requestAnimationFrame(N.bind(e,m))}function T(m,E,v){let b,x,L,V;const F=a();m===t.body?(b=e,x=e.scrollX||e.pageXOffset,L=e.scrollY||e.pageYOffset,V=r.scroll):(b=m,x=m.scrollLeft,L=m.scrollTop,V=l),N({scrollable:b,method:V,startTime:F,startX:x,startY:L,x:E,y:v})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){r.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}T.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){r.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}T.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");r.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const m=arguments[0].left,E=arguments[0].top;T.call(this,this,typeof m>"u"?this.scrollLeft:~~m,typeof E>"u"?this.scrollTop:~~E)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){r.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){r.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const m=y(this),E=m.getBoundingClientRect(),v=this.getBoundingClientRect();m!==t.body?(T.call(this,m,m.scrollLeft+v.left-E.left,m.scrollTop+v.top-E.top),e.getComputedStyle(m).position!=="fixed"&&e.scrollBy({left:E.left,top:E.top,behavior:"smooth"})):e.scrollBy({left:v.left,top:v.top,behavior:"smooth"})}}var I=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(I||{}),D=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(D||{}),_=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(_||{}),An=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(An||{}),Ee=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(Ee||{}),Ae=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(Ae||{}),M=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(M||{});class In{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n.speed}addAction(t){const n=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay)this.actions.push(t);else{const i=this.findActionIndex(t);this.actions.splice(i,0,t)}n&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const t=performance.now();for(this.timeOffset+=(t-this.lastTimestamp)*this.speed,this.lastTimestamp=t;this.actions.length;){const n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,i=this.actions.length-1;for(;n<=i;){const r=Math.floor((n+i)/2);if(this.actions[r].delay<t.delay)n=r+1;else if(this.actions[r].delay>t.delay)i=r-1;else return r+1}return n}}function lt(e,t){if(e.type===I.IncrementalSnapshot&&e.data.source===D.MouseMove&&e.data.positions&&e.data.positions.length){const n=e.data.positions[0].timeOffset,i=e.timestamp+n;return e.delay=i-t,i-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function ct(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),s=[];try{for(;(t===void 0||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(o){r={error:o}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return s}var ie;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(ie||(ie={}));var ut={type:"xstate.init"};function Ie(e){return e===void 0?[]:[].concat(e)}function re(e){return{type:"xstate.assign",assignment:e}}function dt(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function Ne(e){return function(t){return e===t}}function ht(e){return typeof e=="string"?{type:e}:e}function mt(e,t){return{value:e,context:t,actions:[],changed:!1,matches:Ne(e)}}function pt(e,t,n){var i=t,r=!1;return[e.filter(function(a){if(a.type==="xstate.assign"){r=!0;var s=Object.assign({},i);return typeof a.assignment=="function"?s=a.assignment(i,n):Object.keys(a.assignment).forEach(function(o){s[o]=typeof a.assignment[o]=="function"?a.assignment[o](i,n):a.assignment[o]}),i=s,!1}return!0}),i,r]}function ft(e,t){t===void 0&&(t={});var n=ct(pt(Ie(e.states[e.initial].entry).map(function(s){return dt(s,t.actions)}),e.context,ut),2),i=n[0],r=n[1],a={config:e,_options:t,initialState:{value:e.initial,actions:i,context:r,matches:Ne(e.initial)},transition:function(s,o){var l,c,u=typeof s=="string"?{value:s,context:e.context}:s,d=u.value,h=u.context,g=ht(o),y=e.states[d];if(y.on){var N=Ie(y.on[g.type]);try{for(var T=function(k){var ee=typeof Symbol=="function"&&Symbol.iterator,ae=ee&&k[ee],f=0;if(ae)return ae.call(k);if(k&&typeof k.length=="number")return{next:function(){return k&&f>=k.length&&(k=void 0),{value:k&&k[f++],done:!k}}};throw new TypeError(ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(N),m=T.next();!m.done;m=T.next()){var E=m.value;if(E===void 0)return mt(d,h);var v=typeof E=="string"?{target:E}:E,b=v.target,x=v.actions,L=x===void 0?[]:x,V=v.cond,F=V===void 0?function(){return!0}:V,K=b===void 0,pe=b??d,fe=e.states[pe];if(F(h,g)){var J=ct(pt((K?Ie(L):[].concat(y.exit,L,fe.entry).filter(function(k){return k})).map(function(k){return dt(k,a._options.actions)}),h,g),3),Y=J[0],Z=J[1],se=J[2],$=b??d;return{value:$,context:Z,actions:Y,changed:b!==d||Y.length>0||se,matches:Ne($)}}}}catch(k){l={error:k}}finally{try{m&&!m.done&&(c=T.return)&&c.call(T)}finally{if(l)throw l.error}}}return mt(d,h)}};return a}var gt=function(e,t){return e.actions.forEach(function(n){var i=n.exec;return i&&i(e.context,t)})};function yt(e){var t=e.initialState,n=ie.NotStarted,i=new Set,r={_machine:e,send:function(a){n===ie.Running&&(t=e.transition(t,a),gt(t,ht(a)),i.forEach(function(s){return s(t)}))},subscribe:function(a){return i.add(a),a(t),{unsubscribe:function(){return i.delete(a)}}},start:function(a){if(a){var s=typeof a=="object"?a:{context:e.config.context,value:a};t={value:s.value,actions:[],context:s.context,matches:Ne(s.value)}}return n=ie.Running,gt(t,ut),r},stop:function(){return n=ie.Stopped,i.clear(),r},get state(){return t},get status(){return n}};return r}var On=Object.defineProperty,kn=Object.defineProperties,_n=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,Ln=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,Et=(e,t,n)=>t in e?On(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Oe=(e,t)=>{for(var n in t||(t={}))Ln.call(t,n)&&Et(e,n,t[n]);if(vt)for(var n of vt(t))Fn.call(t,n)&&Et(e,n,t[n]);return e},ke=(e,t)=>kn(e,_n(t));function Pn(e,t){for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.type===I.Meta&&i.timestamp<=t)return e.slice(n)}return e}function Un(e,{getCastFn:t,applyEventsSynchronously:n,emitter:i}){const r=ft({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:re({lastPlayedEvent:(a,s)=>s.type==="CAST_EVENT"?s.payload.event:a.lastPlayedEvent}),recordTimeOffset:re((a,s)=>{let o=a.timeOffset;return"payload"in s&&"timeOffset"in s.payload&&(o=s.payload.timeOffset),ke(Oe({},a),{timeOffset:o,baselineTime:a.events[0].timestamp+o})}),play(a){var s;const{timer:o,events:l,baselineTime:c,lastPlayedEvent:u}=a;o.clear();for(const y of l)lt(y,c);const d=Pn(l,c);let h=u?.timestamp;u?.type===I.IncrementalSnapshot&&u.data.source===D.MouseMove&&(h=u.timestamp+((s=u.data.positions[0])==null?void 0:s.timeOffset)),c<(h||0)&&i.emit(M.PlayBack);const g=new Array;for(const y of d)if(!(h&&h<c&&(y.timestamp<=h||y===u)))if(y.timestamp<c)g.push(y);else{const N=t(y,!1);o.addAction({doAction:()=>{N()},delay:y.delay})}n(g),i.emit(M.Flush),o.start()},pause(a){a.timer.clear()},resetLastPlayedEvent:re(a=>ke(Oe({},a),{lastPlayedEvent:null})),startLive:re({baselineTime:(a,s)=>(a.timer.start(),s.type==="TO_LIVE"&&s.payload.baselineTime?s.payload.baselineTime:Date.now())}),addEvent:re((a,s)=>{const{baselineTime:o,timer:l,events:c}=a;if(s.type==="ADD_EVENT"){const{event:u}=s.payload;lt(u,o);let d=c.length-1;if(!c[d]||c[d].timestamp<=u.timestamp)c.push(u);else{let y=-1,N=0;for(;N<=d;){const T=Math.floor((N+d)/2);c[T].timestamp<=u.timestamp?N=T+1:d=T-1}y===-1&&(y=N),c.splice(y,0,u)}const h=u.timestamp<o,g=t(u,h);h?g():l.isActive()&&l.addAction({doAction:()=>{g()},delay:u.delay})}return ke(Oe({},a),{events:c})})}});return yt(r)}function $n(e){const t=ft({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,i)=>{"payload"in i&&n.timer.setSpeed(i.payload.speed)},recordSpeed:re({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return yt(t)}const oe=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let Nt={map:{},getId(){return console.error(oe),-1},getNode(){return console.error(oe),null},removeNodeFromMap(){console.error(oe)},has(){return console.error(oe),!1},reset(){console.error(oe)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Nt=new Proxy(Nt,{get(e,t,n){return t==="map"&&console.error(oe),Reflect.get(e,t,n)}})),/[1-9][0-9]{12}/.test(Date.now().toString());function Bn(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function Vn(e){const t={},n=(r,a)=>{const s={value:r,parent:a,children:[]};return t[r.node.id]=s,s},i=[];for(const r of e){const{nextId:a,parentId:s}=r;if(a&&a in t){const o=t[a];if(o.parent){const l=o.parent.children.indexOf(o);o.parent.children.splice(l,0,n(r,o.parent))}else{const l=i.indexOf(o);i.splice(l,0,n(r,null))}continue}if(s in t){const o=t[s];o.children.push(n(r,o));continue}i.push(n(r,null))}return i}function Tt(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)Tt(e.children[n],t)}function _e(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function wt(e,t){var n,i;const r=(i=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:i.frameElement;if(!r||r===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const a=r.getBoundingClientRect(),s=wt(r,t),o=a.height/r.clientHeight;return{x:a.x*s.relativeScale+s.x,y:a.y*s.relativeScale+s.y,relativeScale:o,absoluteScale:s.absoluteScale*o}}function Te(e){return Boolean(e?.shadowRoot)}function ue(e,t){const n=e[t[0]];return t.length===1?n:ue(n.cssRules[t[1]].cssRules,t.slice(2))}function bt(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function Wn(e){const t=new Set,n=[];for(let i=e.length;i--;){const r=e[i];t.has(r.id)||(n.push(r),t.add(r.id))}return n}class jn{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!=null?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let i;return n===void 0?i=this.id++:i=n,this.styleIDMap.set(t,i),this.idStyleMap.set(i,t),i}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}const Gn=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];for(var St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de=typeof Uint8Array>"u"?[]:new Uint8Array(256),we=0;we<St.length;we++)de[St.charCodeAt(we)]=we;var Yn=function(e){var t=e.length*.75,n=e.length,i,r=0,a,s,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var c=new ArrayBuffer(t),u=new Uint8Array(c);for(i=0;i<n;i+=4)a=de[e.charCodeAt(i)],s=de[e.charCodeAt(i+1)],o=de[e.charCodeAt(i+2)],l=de[e.charCodeAt(i+3)],u[r++]=a<<2|s>>4,u[r++]=(s&15)<<4|o>>2,u[r++]=(o&3)<<6|l&63;return c},Hn=(e,t,n)=>new Promise((i,r)=>{var a=l=>{try{o(n.next(l))}catch(c){r(c)}},s=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((n=n.apply(e,t)).next())});const Mt=new Map;function Dt(e,t){let n=Mt.get(e);return n||(n=new Map,Mt.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function X(e,t,n){return i=>Hn(this,null,function*(){if(i&&typeof i=="object"&&"rr_type"in i)if(n&&(n.isUnchanged=!1),i.rr_type==="ImageBitmap"&&"args"in i){const r=yield X(e,t,n)(i.args);return yield createImageBitmap.apply(null,r)}else if("index"in i){if(n||t===null)return i;const{rr_type:r,index:a}=i;return Dt(t,r)[a]}else if("args"in i){const{rr_type:r,args:a}=i,s=window[r];return new s(...yield Promise.all(a.map(X(e,t,n))))}else{if("base64"in i)return Yn(i.base64);if("src"in i){const r=e.get(i.src);if(r)return r;{const a=new Image;return a.src=i.src,e.set(i.src,a),a}}else if("data"in i&&i.rr_type==="Blob"){const r=yield Promise.all(i.data.map(X(e,t,n)));return new Blob(r,{type:i.type})}}else if(Array.isArray(i))return yield Promise.all(i.map(X(e,t,n)));return i})}var zn=(e,t,n)=>new Promise((i,r)=>{var a=l=>{try{o(n.next(l))}catch(c){r(c)}},s=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((n=n.apply(e,t)).next())});function Xn(e,t){try{return t===Ee.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const Qn=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function qn(e,t){if(!(t!=null&&t.constructor))return;const{name:n}=t.constructor;if(!Qn.includes(n))return;const i=Dt(e,n);i.includes(t)||i.push(t)}function Jn(e){return zn(this,arguments,function*({mutation:t,target:n,type:i,imageMap:r,errorHandler:a}){try{const s=Xn(n,i);if(!s)return;if(t.setter){s[t.property]=t.args[0];return}const o=s[t.property],l=yield Promise.all(t.args.map(X(r,s))),c=o.apply(s,l);qn(s,c)}catch(s){a(t,s)}})}var Ct=(e,t,n)=>new Promise((i,r)=>{var a=l=>{try{o(n.next(l))}catch(c){r(c)}},s=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((n=n.apply(e,t)).next())});function Zn(e){return Ct(this,arguments,function*({event:t,mutations:n,target:i,imageMap:r,errorHandler:a}){const s=i.getContext("2d");if(!s){a(n[0],new Error("Canvas context is null"));return}const o=n.map(l=>Ct(this,null,function*(){return Promise.all(l.args.map(X(r,s)))}));(yield Promise.all(o)).forEach((l,c)=>{const u=n[c];try{if(u.setter){s[u.property]=u.args[0];return}const d=s[u.property];u.property==="drawImage"&&typeof u.args[0]=="string"?(r.get(t),d.apply(s,u.args)):d.apply(s,l)}catch(d){a(u,d)}})})}var Kn=(e,t,n)=>new Promise((i,r)=>{var a=l=>{try{o(n.next(l))}catch(c){r(c)}},s=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((n=n.apply(e,t)).next())});function Rt(e){return Kn(this,arguments,function*({event:t,mutation:n,target:i,imageMap:r,canvasEventMap:a,errorHandler:s}){try{const o=a.get(t)||n,l="commands"in o?o.commands:[o];if([Ee.WebGL,Ee.WebGL2].includes(n.type)){for(let c=0;c<l.length;c++){const u=l[c];yield Jn({mutation:u,type:n.type,target:i,imageMap:r,errorHandler:s})}return}yield Zn({event:t,mutations:l,target:i,imageMap:r,errorHandler:s})}catch(o){s(n,o)}})}class ei{constructor(t){this.mediaMap=new Map,this.metadataCallbackMap=new Map,this.warn=t.warn,this.service=t.service,this.speedService=t.speedService,this.emitter=t.emitter,this.getCurrentTime=t.getCurrentTime,this.emitter.on(M.Start,this.start.bind(this)),this.emitter.on(M.SkipStart,this.start.bind(this)),this.emitter.on(M.Pause,this.pause.bind(this)),this.emitter.on(M.Finish,this.pause.bind(this)),this.speedService.subscribe(()=>{this.syncAllMediaElements()})}syncAllMediaElements(t={pause:!1}){this.mediaMap.forEach((n,i)=>{this.syncTargetWithState(i),t.pause&&i.pause()})}start(){this.syncAllMediaElements()}pause(){this.syncAllMediaElements({pause:!0})}seekTo({time:t,target:n,mediaState:i}){if(i.isPlaying){const r=(t-i.lastInteractionTimeOffset)/1e3*i.playbackRate,a="duration"in n&&n.duration;if(Number.isNaN(a)){this.waitForMetadata(n);return}let s=i.currentTimeAtLastInteraction+r;n.loop&&a!==!1&&(s=s%a),n.currentTime=s}else n.pause(),n.currentTime=i.currentTimeAtLastInteraction}waitForMetadata(t){if(this.metadataCallbackMap.has(t)||!("addEventListener"in t))return;const n=()=>{this.metadataCallbackMap.delete(t);const i=this.mediaMap.get(t);!i||this.seekTo({time:this.getCurrentTime(),target:t,mediaState:i})};this.metadataCallbackMap.set(t,n),t.addEventListener("loadedmetadata",n,{once:!0})}getMediaStateFromMutation({target:t,timeOffset:n,mutation:i}){var r,a,s,o,l;const c=this.mediaMap.get(t),{type:u,playbackRate:d,currentTime:h,muted:g,volume:y,loop:N}=i;return{isPlaying:u===Ae.Play||u!==Ae.Pause&&(c?.isPlaying||t.getAttribute("autoplay")!==null),currentTimeAtLastInteraction:(r=h??c?.currentTimeAtLastInteraction)!=null?r:0,lastInteractionTimeOffset:n,playbackRate:(a=d??c?.playbackRate)!=null?a:1,volume:(s=y??c?.volume)!=null?s:1,muted:(o=g??c?.muted)!=null?o:t.getAttribute("muted")===null,loop:(l=N??c?.loop)!=null?l:t.getAttribute("loop")===null}}syncTargetWithState(t){const n=this.mediaMap.get(t);if(!n)return;const{muted:i,loop:r,volume:a,isPlaying:s}=n,o=this.service.state.matches("paused"),l=n.playbackRate*this.speedService.state.context.timer.speed;try{this.seekTo({time:this.getCurrentTime(),target:t,mediaState:n}),t.volume!==a&&(t.volume=a),t.muted=i,t.loop=r,t.playbackRate!==l&&(t.playbackRate=l),s&&!o?t.play():t.pause()}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}}addMediaElements(t,n,i){if(!["AUDIO","VIDEO"].includes(t.nodeName))return;const r=t,a=i.getMeta(r);if(!a||!("attributes"in a))return;const s=this.service.state.matches("paused"),o=a.attributes;let l=!1;o.rr_mediaState?l=o.rr_mediaState==="played":l=r.getAttribute("autoplay")!==null,l&&s&&r.pause();let c=1;typeof o.rr_mediaPlaybackRate=="number"&&(c=o.rr_mediaPlaybackRate);let u=!1;typeof o.rr_mediaMuted=="boolean"?u=o.rr_mediaMuted:u=r.getAttribute("muted")!==null;let d=!1;typeof o.rr_mediaLoop=="boolean"?d=o.rr_mediaLoop:d=r.getAttribute("loop")!==null;let h=1;typeof o.rr_mediaVolume=="number"&&(h=o.rr_mediaVolume);let g=0;typeof o.rr_mediaCurrentTime=="number"&&(g=o.rr_mediaCurrentTime),this.mediaMap.set(r,{isPlaying:l,currentTimeAtLastInteraction:g,lastInteractionTimeOffset:n,playbackRate:c,volume:h,muted:u,loop:d}),this.syncTargetWithState(r)}mediaMutation({target:t,timeOffset:n,mutation:i}){this.mediaMap.set(t,this.getMediaStateFromMutation({target:t,timeOffset:n,mutation:i})),this.syncTargetWithState(t)}isSupportedMediaElement(t){return["AUDIO","VIDEO"].includes(t.nodeName)}reset(){this.mediaMap.clear()}}var ti=Object.defineProperty,ni=Object.defineProperties,ii=Object.getOwnPropertyDescriptors,xt=Object.getOwnPropertySymbols,ri=Object.prototype.hasOwnProperty,oi=Object.prototype.propertyIsEnumerable,At=(e,t,n)=>t in e?ti(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,be=(e,t)=>{for(var n in t||(t={}))ri.call(t,n)&&At(e,n,t[n]);if(xt)for(var n of xt(t))oi.call(t,n)&&At(e,n,t[n]);return e},Le=(e,t)=>ni(e,ii(t)),Fe=(e,t,n)=>new Promise((i,r)=>{var a=l=>{try{o(n.next(l))}catch(c){r(c)}},s=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,s);o((n=n.apply(e,t)).next())});const si=5*1e3,ai=at||Rn,It="[replayer]",Pe={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Ot(e){return e.type==I.IncrementalSnapshot&&(e.data.source==D.TouchMove||e.data.source==D.MouseInteraction&&e.data.type==_.TouchStart)}class li{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new ne,this.mouseTail=null,this.tailPositions=[],this.emitter=ai(),this.legacy_missingNodeRetryMap={},this.cache=Qe(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Gt(),this.styleMirror=new jn,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=o=>{this.iframe.style.display="inherit";for(const l of[this.mouseTail,this.iframe])!l||(l.setAttribute("width",String(o.width)),l.setAttribute("height",String(o.height)))},this.applyEventsSynchronously=o=>{for(const l of o){switch(l.type){case I.DomContentLoaded:case I.Load:case I.Custom:continue;case I.FullSnapshot:case I.Meta:case I.Plugin:case I.IncrementalSnapshot:break}this.getCastFn(l,!0)()}},this.getCastFn=(o,l=!1)=>{let c;switch(o.type){case I.DomContentLoaded:case I.Load:break;case I.Custom:c=()=>{this.emitter.emit(M.CustomEvent,o)};break;case I.Meta:c=()=>this.emitter.emit(M.Resize,{width:o.data.width,height:o.data.height});break;case I.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===o){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.mediaManager.reset(),this.styleMirror.reset(),this.rebuildFullSnapshot(o,l),(u=this.iframe.contentWindow)==null||u.scrollTo(o.data.initialOffset)};break;case I.IncrementalSnapshot:c=()=>{if(this.applyIncremental(o,l),!l&&(o===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=o.timestamp)&&this.isUserInteraction(u)){u.delay-o.delay>this.config.inactivePeriodThreshold*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-o.delay,d={speed:Math.min(Math.round(u/si),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(M.SkipStart,d)}}};break}return()=>{c&&c();for(const d of this.config.plugins||[])d.handler&&d.handler(o,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:o}});const u=this.service.state.context.events.length-1;if(!this.config.liveMode&&o===this.service.state.context.events[u]){const d=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(M.Finish))};let h=50;o.type===I.IncrementalSnapshot&&o.data.source===D.MouseMove&&o.data.positions.length&&(h+=Math.max(0,-o.data.positions[0].timeOffset)),setTimeout(d,h)}this.emitter.emit(M.EventCast,o)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const i={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,inactivePeriodThreshold:10*1e3,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Pe,useVirtualDom:!0,logger:console};this.config=Object.assign({},i,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(M.Resize,this.handleResize),this.setupDom();for(const o of this.config.plugins||[])o.getMirror&&o.getMirror({nodeMirror:this.mirror});this.emitter.on(M.Flush,()=>{if(this.usingVirtualDom){const o={mirror:this.mirror,applyCanvas:(l,c,u)=>{Rt({event:l,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,c)=>{l.source===D.StyleSheetRule?this.applyStyleSheetRule(l,c):l.source===D.StyleDeclaration&&this.applyStyleDeclaration(l,c)},afterAppend:(l,c)=>{for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(l,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{ye(this.iframe.contentDocument,this.virtualDom,o,this.virtualDom.mirror)}catch(l){console.warn(l)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const l in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[l],u=ve(c.node,this.mirror,this.virtualDom.mirror);ye(u,c.node,o,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[o,l]=this.lastMouseDownEvent;o.dispatchEvent(l)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(M.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset()});const r=new In([],{speed:this.config.speed});this.service=Un({events:t.map(o=>n&&n.unpackFn?n.unpackFn(o):o).sort((o,l)=>o.timestamp-l.timestamp),timer:r,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(o=>{this.emitter.emit(M.StateChange,{player:o})}),this.speedService=$n({normalSpeed:-1,timer:r}),this.speedService.start(),this.speedService.subscribe(o=>{this.emitter.emit(M.StateChange,{speed:o})}),this.mediaManager=new ei({warn:this.warn.bind(this),service:this.service,speedService:this.speedService,emitter:this.emitter,getCurrentTime:this.getCurrentTime.bind(this)});const a=this.service.state.context.events.find(o=>o.type===I.Meta),s=this.service.state.context.events.find(o=>o.type===I.FullSnapshot);if(a){const{width:o,height:l}=a.data;setTimeout(()=>{this.emitter.emit(M.Resize,{width:o,height:l})},0)}s&&setTimeout(()=>{var o;this.firstFullSnapshot||(this.firstFullSnapshot=s,this.rebuildFullSnapshot(s),(o=this.iframe.contentWindow)==null||o.scrollTo(s.data.initialOffset))},1),this.service.state.context.events.find(Ot)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,i;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(i=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||i.classList.remove("rrweb-paused"),this.emitter.emit(M.Start)}pause(t){var n,i;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(i=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||i.classList.add("rrweb-paused"),this.emitter.emit(M.Pause)}resume(t=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(M.Resume)}destroy(){this.pause(),this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset(),this.config.root.removeChild(this.wrapper),this.emitter.emit(M.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;Ot(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=Qe()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(xn(this.iframe.contentWindow,this.iframe.contentDocument),Bn(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const i=[],r=(o,l)=>{if(this.collectIframeAndAttachDocument(i,o),this.mediaManager.isSupportedMediaElement(o)){const{events:c}=this.service.state.context;this.mediaManager.addMediaElements(o,t.timestamp-c[0].timestamp,this.mirror)}for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(o,{id:l,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),en(t.data.node,{doc:this.iframe.contentDocument,afterAppend:r,cache:this.cache,mirror:this.mirror}),r(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:o,builtNode:l}of i)this.attachDocumentToIframe(o,l),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==o);const{documentElement:a,head:s}=this.iframe.contentDocument;this.insertStyleRules(a,s),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(M.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){var i;const r=Gn(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&r.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const a=this.virtualDom.createElement("style");this.virtualDom.mirror.add(a,st(a,this.virtualDom.unserializedId)),t.insertBefore(a,n),a.rules.push({source:D.StyleSheetRule,adds:r.map((s,o)=>({rule:s,index:o}))})}else{const a=document.createElement("style");t.insertBefore(a,n);for(let s=0;s<r.length;s++)(i=a.sheet)==null||i.insertRule(r[s],s)}}attachDocumentToIframe(t,n){const i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,r=[],a=(s,o)=>{this.collectIframeAndAttachDocument(r,s);const l=i.getMeta(s);if(l?.type===C.Element&&l?.tagName.toUpperCase()==="HTML"){const{documentElement:c,head:u}=n.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(s,{id:o,replayer:this})};le(t.node,{doc:n.contentDocument,mirror:i,hackCss:!0,skipChild:!1,afterAppend:a,cache:this.cache}),a(n.contentDocument,t.node.id);for(const{mutationInQueue:s,builtNode:o}of r)this.attachDocumentToIframe(s,o),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==s)}collectIframeAndAttachDocument(t,n){if(_e(n,this.mirror)){const i=this.newDocumentQueue.find(r=>r.parentId===this.mirror.getId(n));i&&t.push({mutationInQueue:i,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)==null?void 0:t.head;if(n){const i=new Set;let r,a=this.service.state;const s=()=>{a=this.service.state};this.emitter.on(M.Start,s),this.emitter.on(M.Pause,s);const o=()=>{this.emitter.off(M.Start,s),this.emitter.off(M.Pause,s)};n.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(i.add(l),l.addEventListener("load",()=>{i.delete(l),i.size===0&&r!==-1&&(a.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(M.LoadStylesheetEnd),r&&clearTimeout(r),o())}))}),i.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(M.LoadStylesheetStart),r=setTimeout(()=>{a.matches("playing")&&this.play(this.getCurrentTime()),r=-1,o()},this.config.loadTimeout))}}preloadAllImages(){return Fe(this,null,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(M.Start,t),this.emitter.on(M.Pause,t);const n=[];for(const i of this.service.state.context.events)i.type===I.IncrementalSnapshot&&i.data.source===D.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(i.data,i)),("commands"in i.data?i.data.commands:[i.data]).forEach(r=>{this.preloadImages(r,i)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const i=document.createElement("canvas"),r=i.getContext("2d"),a=r?.createImageData(i.width,i.height);a?.data,JSON.parse(t.args[0]),r?.putImageData(a,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return Fe(this,null,function*(){if(!this.canvasEventMap.has(n)){const i={isUnchanged:!0};if("commands"in t){const r=yield Promise.all(t.commands.map(a=>Fe(this,null,function*(){const s=yield Promise.all(a.args.map(X(this.imageMap,null,i)));return Le(be({},a),{args:s})})));i.isUnchanged===!1&&this.canvasEventMap.set(n,Le(be({},t),{commands:r}))}else{const r=yield Promise.all(t.args.map(X(this.imageMap,null,i)));i.isUnchanged===!1&&this.canvasEventMap.set(n,Le(be({},t),{args:r}))}}})}applyIncremental(t,n){var i,r,a;const{data:s}=t;switch(s.source){case D.Mutation:{try{this.applyMutation(s,n)}catch(o){this.warn(`Exception in mutation ${o.message||o}`,s)}break}case D.Drag:case D.TouchMove:case D.MouseMove:if(n){const o=s.positions[s.positions.length-1];this.mousePos={x:o.x,y:o.y,id:o.id,debugData:s}}else s.positions.forEach(o=>{const l={doAction:()=>{this.moveAndHover(o.x,o.y,o.id,n,s)},delay:o.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:t.delay-((i=s.positions[0])==null?void 0:i.timeOffset)});break;case D.MouseInteraction:{if(s.id===-1)break;const o=new Event(Yt(_[s.type])),l=this.mirror.getNode(s.id);if(!l)return this.debugNodeNotFound(s,s.id);this.emitter.emit(M.MouseInteraction,{type:s.type,target:l});const{triggerFocus:c}=this.config;switch(s.type){case _.Blur:"blur"in l&&l.blur();break;case _.Focus:c&&l.focus&&l.focus({preventScroll:!0});break;case _.Click:case _.TouchStart:case _.TouchEnd:case _.MouseDown:case _.MouseUp:n?(s.type===_.TouchStart?this.touchActive=!0:s.type===_.TouchEnd&&(this.touchActive=!1),s.type===_.MouseDown?this.lastMouseDownEvent=[l,o]:s.type===_.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:s.x||0,y:s.y||0,id:s.id,debugData:s}):(s.type===_.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(s.x||0,s.y||0,s.id,n,s),s.type===_.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):s.type===_.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):s.type===_.TouchEnd?this.mouse.classList.remove("touch-active"):l.dispatchEvent(o));break;case _.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(o)}break}case D.Scroll:{if(s.id===-1)break;if(this.usingVirtualDom){const o=this.virtualDom.mirror.getNode(s.id);if(!o)return this.debugNodeNotFound(s,s.id);o.scrollData=s;break}this.applyScroll(s,n);break}case D.ViewportResize:this.emitter.emit(M.Resize,{width:s.width,height:s.height});break;case D.Input:{if(s.id===-1)break;if(this.usingVirtualDom){const o=this.virtualDom.mirror.getNode(s.id);if(!o)return this.debugNodeNotFound(s,s.id);o.inputData=s;break}this.applyInput(s);break}case D.MediaInteraction:{const o=this.usingVirtualDom?this.virtualDom.mirror.getNode(s.id):this.mirror.getNode(s.id);if(!o)return this.debugNodeNotFound(s,s.id);const l=o,{events:c}=this.service.state.context;this.mediaManager.mediaMutation({target:l,timeOffset:t.timestamp-c[0].timestamp,mutation:s});break}case D.StyleSheetRule:case D.StyleDeclaration:{this.usingVirtualDom?s.styleId?this.constructedStyleMutations.push(s):s.id&&((r=this.virtualDom.mirror.getNode(s.id))==null||r.rules.push(s)):this.applyStyleSheetMutation(s);break}case D.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const o=this.virtualDom.mirror.getNode(s.id);if(!o)return this.debugNodeNotFound(s,s.id);o.canvasMutations.push({event:t,mutation:s})}else{const o=this.mirror.getNode(s.id);if(!o)return this.debugNodeNotFound(s,s.id);Rt({event:t,mutation:s,target:o,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case D.Font:{try{const o=new FontFace(s.family,s.buffer?new Uint8Array(JSON.parse(s.fontSource)):s.fontSource,s.descriptors);(a=this.iframe.contentDocument)==null||a.fonts.add(o)}catch(o){this.warn(o)}break}case D.Selection:{if(n){this.lastSelectionData=s;break}this.applySelection(s);break}case D.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(s):this.applyAdoptedStyleSheet(s);break}}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,Mn(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],d=ot(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.warn(u)}const i=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes=t.removes.filter(c=>i.getNode(c.id)?!0:(this.warnNodeNotFound(t,c.id),!1)),t.removes.forEach(c=>{var u;const d=i.getNode(c.id);if(!d)return;let h=i.getNode(c.parentId);if(!h)return this.warnNodeNotFound(t,c.parentId);if(c.isShadow&&Te(h)&&(h=h.shadowRoot),i.removeNodeFromMap(d),h)try{h.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&h.nodeName==="STYLE"&&((u=h.rules)==null?void 0:u.length)>0&&(h.rules=[])}catch(g){if(g instanceof DOMException)this.warn("parent could not remove child in mutation",h,d,t);else throw g}});const r=be({},this.legacy_missingNodeRetryMap),a=[],s=c=>{let u=null;return c.nextId&&(u=i.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},o=c=>{var u,d;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let h=i.getNode(c.parentId);if(!h)return c.node.type===C.Document?this.newDocumentQueue.push(c):a.push(c);c.node.isShadow&&(Te(h)||h.attachShadow({mode:"open"}),h=h.shadowRoot);let g=null,y=null;if(c.previousId&&(g=i.getNode(c.previousId)),c.nextId&&(y=i.getNode(c.nextId)),s(c))return a.push(c);if(c.node.rootId&&!i.getNode(c.node.rootId))return;const N=c.node.rootId?i.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(_e(h,i)){this.attachDocumentToIframe(c,h);return}const T=(v,b)=>{if(!this.usingVirtualDom)for(const x of this.config.plugins||[])x.onBuild&&x.onBuild(v,{id:b,replayer:this})},m=le(c.node,{doc:N,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:T});if(c.previousId===-1||c.nextId===-1){r[c.node.id]={node:m,mutation:c};return}const E=i.getMeta(h);if(E&&E.type===C.Element&&E.tagName==="textarea"&&c.node.type===C.Text){const v=Array.isArray(h.childNodes)?h.childNodes:Array.from(h.childNodes);for(const b of v)b.nodeType===h.TEXT_NODE&&h.removeChild(b)}else if(E?.type===C.Document){const v=h;c.node.type===C.DocumentType&&((u=v.childNodes[0])==null?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&v.removeChild(v.childNodes[0]),m.nodeName==="HTML"&&v.documentElement&&v.removeChild(v.documentElement)}if(g&&g.nextSibling&&g.nextSibling.parentNode?h.insertBefore(m,g.nextSibling):y&&y.parentNode?h.contains(y)?h.insertBefore(m,y):h.insertBefore(m,null):h.appendChild(m),T(m,c.node.id),this.usingVirtualDom&&m.nodeName==="#text"&&h.nodeName==="STYLE"&&((d=h.rules)==null?void 0:d.length)>0&&(h.rules=[]),_e(m,this.mirror)){const v=this.mirror.getId(m),b=this.newDocumentQueue.find(x=>x.parentId===v);b&&(this.attachDocumentToIframe(b,m),this.newDocumentQueue=this.newDocumentQueue.filter(x=>x!==b))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(r,h,m,c)};t.adds.forEach(c=>{o(c)});const l=Date.now();for(;a.length;){const c=Vn(a);if(a.length=0,Date.now()-l>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)i.getNode(u.value.parentId)?Tt(u,d=>{o(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(r).length&&Object.assign(this.legacy_missingNodeRetryMap,r),Wn(t.texts).forEach(c=>{var u;const d=i.getNode(c.id);if(!d)return t.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);if(d.textContent=c.value,this.usingVirtualDom){const h=d.parentNode;((u=h?.rules)==null?void 0:u.length)>0&&(h.rules=[])}}),t.attributes.forEach(c=>{var u;const d=i.getNode(c.id);if(!d)return t.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);for(const h in c.attributes)if(typeof h=="string"){const g=c.attributes[h];if(g===null)d.removeAttribute(h);else if(typeof g=="string")try{if(h==="_cssText"&&(d.nodeName==="LINK"||d.nodeName==="STYLE"))try{const y=i.getMeta(d);Object.assign(y.attributes,c.attributes);const N=le(y,{doc:d.ownerDocument,mirror:i,skipChild:!0,hackCss:!0,cache:this.cache}),T=d.nextSibling,m=d.parentNode;if(N&&m){m.removeChild(d),m.insertBefore(N,T),i.replace(c.id,N);break}}catch{}if(h==="value"&&d.nodeName==="TEXTAREA"){const y=d;y.childNodes.forEach(T=>y.removeChild(T));const N=(u=d.ownerDocument)==null?void 0:u.createTextNode(g);N&&y.appendChild(N)}else d.setAttribute(h,g)}catch(y){this.warn("An error occurred may due to the checkout feature.",y)}else if(h==="style"){const y=g,N=d;for(const T in y)if(y[T]===!1)N.style.removeProperty(T);else if(y[T]instanceof Array){const m=y[T];N.style.setProperty(T,m[0],m[1])}else{const m=y[T];N.style.setProperty(T,m)}}}})}applyScroll(t,n){var i,r;const a=this.mirror.getNode(t.id);if(!a)return this.debugNodeNotFound(t,t.id);const s=this.mirror.getMeta(a);if(a===this.iframe.contentDocument)(i=this.iframe.contentWindow)==null||i.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if(s?.type===C.Document)(r=a.defaultView)==null||r.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{a.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}applySelection(t){try{const n=new Set,i=t.ranges.map(({start:r,startOffset:a,end:s,endOffset:o})=>{const l=this.mirror.getNode(r),c=this.mirror.getNode(s);if(!l||!c)return;const u=new Range;u.setStart(l,a),u.setEnd(c,o);const d=l.ownerDocument,h=d?.getSelection();return h&&n.add(h),{range:u,selection:h}});n.forEach(r=>r.removeAllRanges()),i.forEach(r=>{var a;return r&&((a=r.selection)==null?void 0:a.addRange(r.range))})}catch{}}applyStyleSheetMutation(t){var n;let i=null;t.styleId?i=this.styleMirror.getStyle(t.styleId):t.id&&(i=((n=this.mirror.getNode(t.id))==null?void 0:n.sheet)||null),i&&(t.source===D.StyleSheetRule?this.applyStyleSheetRule(t,i):t.source===D.StyleDeclaration&&this.applyStyleDeclaration(t,i))}applyStyleSheetRule(t,n){var i,r,a,s;if((i=t.adds)==null||i.forEach(({rule:o,index:l})=>{try{if(Array.isArray(l)){const{positions:c,index:u}=bt(l);ue(n.cssRules,c).insertRule(o,u)}else{const c=l===void 0?void 0:Math.min(l,n.cssRules.length);n?.insertRule(o,c)}}catch{}}),(r=t.removes)==null||r.forEach(({index:o})=>{try{if(Array.isArray(o)){const{positions:l,index:c}=bt(o);ue(n.cssRules,l).deleteRule(c||0)}else n?.deleteRule(o)}catch{}}),t.replace)try{(a=n.replace)==null||a.call(n,t.replace)}catch{}if(t.replaceSync)try{(s=n.replaceSync)==null||s.call(n,t.replaceSync)}catch{}}applyStyleDeclaration(t,n){t.set&&ue(n.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&ue(n.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var n;const i=this.mirror.getNode(t.id);if(!i)return;(n=t.styles)==null||n.forEach(o=>{var l;let c=null,u=null;if(Te(i)?u=((l=i.ownerDocument)==null?void 0:l.defaultView)||null:i.nodeName==="#document"&&(u=i.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,o.styleId),this.applyStyleSheetRule({source:D.StyleSheetRule,adds:o.rules},c)}catch{}});const r=10;let a=0;const s=(o,l)=>{const c=l.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);Te(o)?o.shadowRoot.adoptedStyleSheets=c:o.nodeName==="#document"&&(o.adoptedStyleSheets=c),c.length!==l.length&&a<r&&(setTimeout(()=>s(o,l),0+100*a),a++)};s(i,t.styleIds)}legacy_resolveMissingNode(t,n,i,r){const{previousId:a,nextId:s}=r,o=a&&t[a],l=s&&t[s];if(o){const{node:c,mutation:u}=o;n.insertBefore(c,i),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}if(l){const{node:c,mutation:u}=l;n.insertBefore(c,i.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}}moveAndHover(t,n,i,r,a){const s=this.mirror.getNode(i);if(!s)return this.debugNodeNotFound(a,i);const o=wt(s,this.iframe),l=t*o.absoluteScale+o.x,c=n*o.absoluteScale+o.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${c}px`,r||this.drawMouseTail({x:l,y:c}),this.hoverElements(s)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:i,strokeStyle:r,duration:a}=this.config.mouseTail===!0?Pe:Object.assign({},Pe,this.config.mouseTail),s=()=>{if(!this.mouseTail)return;const o=this.mouseTail.getContext("2d");!o||!this.tailPositions.length||(o.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),o.beginPath(),o.lineWidth=i,o.lineCap=n,o.strokeStyle=r,o.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>o.lineTo(l.x,l.y)),o.stroke())};this.tailPositions.push(t),s(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(o=>o!==t),s()},a/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.lastHoveredRootNode||this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(r=>{r.classList.remove(":hover")}),this.lastHoveredRootNode=t.getRootNode();let i=t;for(;i;)i.classList&&i.classList.add(":hover"),i=i.parentElement}isUserInteraction(t){return t.type!==I.IncrementalSnapshot?!1:t.data.source>D.Mutation&&t.data.source<=D.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(M.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug(`Node with id '${n}' not found. `,t)}warn(...t){!this.config.showWarning||this.config.logger.warn(It,...t)}debug(...t){!this.config.showDebug||this.config.logger.log(It,...t)}}var B=Uint8Array,Q=Uint16Array,Ue=Uint32Array,kt=new B([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_t=new B([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ci=new B([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Lt=function(e,t){for(var n=new Q(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];for(var r=new Ue(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)r[a]=a-n[i]<<5|i;return[n,r]},Ft=Lt(kt,2),Pt=Ft[0],ui=Ft[1];Pt[28]=258,ui[258]=28;for(var di=Lt(_t,0),hi=di[0],$e=new Q(32768),R=0;R<32768;++R){var q=(R&43690)>>>1|(R&21845)<<1;q=(q&52428)>>>2|(q&13107)<<2,q=(q&61680)>>>4|(q&3855)<<4,$e[R]=((q&65280)>>>8|(q&255)<<8)>>>1}for(var he=function(e,t,n){for(var i=e.length,r=0,a=new Q(t);r<i;++r)++a[e[r]-1];var s=new Q(t);for(r=0;r<t;++r)s[r]=s[r-1]+a[r-1]<<1;var o;if(n){o=new Q(1<<t);var l=15-t;for(r=0;r<i;++r)if(e[r])for(var c=r<<4|e[r],u=t-e[r],d=s[e[r]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)o[$e[d]>>>l]=c}else for(o=new Q(i),r=0;r<i;++r)o[r]=$e[s[e[r]-1]++]>>>15-e[r];return o},me=new B(288),R=0;R<144;++R)me[R]=8;for(var R=144;R<256;++R)me[R]=9;for(var R=256;R<280;++R)me[R]=7;for(var R=280;R<288;++R)me[R]=8;for(var Ut=new B(32),R=0;R<32;++R)Ut[R]=5;var mi=he(me,9,1),pi=he(Ut,5,1),Be=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},G=function(e,t,n){var i=t/8>>0;return(e[i]|e[i+1]<<8)>>>(t&7)&n},Ve=function(e,t){var n=t/8>>0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>>(t&7)},fi=function(e){return(e/8>>0)+(e&7&&1)},$t=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var i=new(e instanceof Q?Q:e instanceof Ue?Ue:B)(n-t);return i.set(e.subarray(t,n)),i},gi=function(e,t,n){var i=e.length,r=!t||n,a=!n||n.i;n||(n={}),t||(t=new B(i*3));var s=function(j){var Se=t.length;if(j>Se){var Vt=new B(Math.max(Se*2,j));Vt.set(t),t=Vt}},o=n.f||0,l=n.p||0,c=n.b||0,u=n.l,d=n.d,h=n.m,g=n.n,y=i*8;do{if(!u){n.f=o=G(e,l,1);var N=G(e,l+1,3);if(l+=3,N)if(N==1)u=mi,d=pi,h=9,g=5;else if(N==2){var v=G(e,l,31)+257,b=G(e,l+10,15)+4,x=v+G(e,l+5,31)+1;l+=14;for(var L=new B(x),V=new B(19),F=0;F<b;++F)V[ci[F]]=G(e,l+F*3,7);l+=b*3;var K=Be(V),pe=(1<<K)-1;if(!a&&l+x*(K+7)>y)break;for(var fe=he(V,K,1),F=0;F<x;){var J=fe[G(e,l,pe)];l+=J&15;var T=J>>>4;if(T<16)L[F++]=T;else{var Y=0,Z=0;for(T==16?(Z=3+G(e,l,3),l+=2,Y=L[F-1]):T==17?(Z=3+G(e,l,7),l+=3):T==18&&(Z=11+G(e,l,127),l+=7);Z--;)L[F++]=Y}}var se=L.subarray(0,v),$=L.subarray(v);h=Be(se),g=Be($),u=he(se,h,1),d=he($,g,1)}else throw"invalid block type";else{var T=fi(l)+4,m=e[T-4]|e[T-3]<<8,E=T+m;if(E>i){if(a)throw"unexpected EOF";break}r&&s(c+m),t.set(e.subarray(T,E),c),n.b=c+=m,n.p=l=E*8;continue}if(l>y)throw"unexpected EOF"}r&&s(c+131072);for(var k=(1<<h)-1,ee=(1<<g)-1,ae=h+g+18;a||l+ae<y;){var Y=u[Ve(e,l)&k],f=Y>>>4;if(l+=Y&15,l>y)throw"unexpected EOF";if(!Y)throw"invalid length/literal";if(f<256)t[c++]=f;else if(f==256){u=null;break}else{var p=f-254;if(f>264){var F=f-257,w=kt[F];p=G(e,l,(1<<w)-1)+Pt[F],l+=w}var A=d[Ve(e,l)&ee],P=A>>>4;if(!A)throw"invalid distance";l+=A&15;var $=hi[P];if(P>3){var w=_t[P];$+=Ve(e,l)&(1<<w)-1,l+=w}if(l>y)throw"unexpected EOF";r&&s(c+131072);for(var W=c+p;c<W;c+=4)t[c]=t[c-$],t[c+1]=t[c+1-$],t[c+2]=t[c+2-$],t[c+3]=t[c+3-$];c=W}}n.l=u,n.p=l,n.b=c,u&&(o=1,n.m=h,n.d=d,n.n=g)}while(!o);return c==t.length?t:$t(t,0,c)},yi=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function vi(e,t){return gi((yi(e),e.subarray(2,-4)),t)}function Ei(e,t){var n=e.length;if(!t&&typeof TextEncoder<"u")return new TextEncoder().encode(e);for(var i=new B(e.length+(e.length>>>1)),r=0,a=function(c){i[r++]=c},s=0;s<n;++s){if(r+5>i.length){var o=new B(r+8+(n-s<<1));o.set(i),i=o}var l=e.charCodeAt(s);l<128||t?a(l):l<2048?(a(192|l>>>6),a(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|e.charCodeAt(++s)&1023,a(240|l>>>18),a(128|l>>>12&63),a(128|l>>>6&63),a(128|l&63)):(a(224|l>>>12),a(128|l>>>6&63),a(128|l&63))}return $t(i,0,r)}function Ni(e,t){var n="";if(!t&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var i=0;i<e.length;){var r=e[i++];r<128||t?n+=String.fromCharCode(r):r<224?n+=String.fromCharCode((r&31)<<6|e[i++]&63):r<240?n+=String.fromCharCode((r&15)<<12|(e[i++]&63)<<6|e[i++]&63):(r=((r&15)<<18|(e[i++]&63)<<12|(e[i++]&63)<<6|e[i++]&63)-65536,n+=String.fromCharCode(55296|r>>10,56320|r&1023))}return n}const Bt="v1",Ti=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch{}try{const t=JSON.parse(Ni(vi(Ei(e,!0))));if(t.v===Bt)return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer ${Bt}.`)}catch(t){throw console.error(t),new Error("Unknown data format.")}};return ge.Replayer=li,ge.unpack=Ti,Object.defineProperty(ge,"__esModule",{value:!0}),ge}({});
//# sourceMappingURL=rrweb-replay-unpack.min.js.map
